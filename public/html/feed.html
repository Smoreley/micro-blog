<link rel="stylesheet" href="/css/postfeed.css">

<div id="feedContainer">
    <div class="row" id="feednav">
        <div class="col-xs-4">
            <a href="#" id="latestbttn"><div class="glyphicon glyphicon-pencil"></div></a>
        </div>
        <div class="col-xs-4">
            <a href="#" id="accountbttn"><div class="glyphicon glyphicon-cog"></div></a>
        </div>
        <div class="col-xs-4">
            <input id="srch" name="srch" placeholder="search id">
            <a href="#" id="searchbttn" onclick="passVal()"><div class="glyphicon glyphicon-search"></div></a>
        </div>
    </div><br>    
    <div id="posts"></div>

</div>

<script>
<<<<<<< HEAD
// $(function() {
    function passVal() {
        clearSearch();
        srch = $("#srch").val();
        console.log(srch);
            $.post("/getposts", function(result) {
                var a = $.parseJSON(result);

                if (srch=="") {
                    for(var i = 0; i < a.length; i++ ) {
                        createPost(a[i].username, "default_01.png", a[i].post, a[i].timestamp);
                    }
                    return;
                }

                for(var i = 0; i < a.length; i++ ) {
                    if (a[i].username==srch) {
                        createPost(a[i].username, "default_01.png", a[i].post, a[i].timestamp);
                    }
        //            $.post("/getuserinfo", a[i].username, function(res) {
        //            });
                }
            }); 
    }

//    var username = "sarah";
//    var profilepic = "default_01.png";
//    var post = "This is my awesome post data";
//    var pdate = "00/00/00";
//    
//    createPost(username, profilepic, post, pdate);
    
// });
function clearSearch() {
    $("#posts").html("");
}

=======
$(function() {
    
    $.post("/getposts", function(result) {
        var a = $.parseJSON(result);
        
        for(var i = 0; i < a.length; i++ ) {
            (function(i) {
                var formData = {id:a[i].username};
                $.post("/finduser", formData, (res) => {
                    var bval = $.parseJSON(res);
                    createPost(bval.fname, bval.picture, a[i].post, a[i].timestamp);       
                });
            })(i);
        }
    });
    
});
    
>>>>>>> origin/master
function createPost(uname, ppic, ptext, pdate) {
    $("#posts").append(
        "<div class=\'media\'>"+
            "<div class=\"media-left\">"+
            "<img src=\'image/"+ppic+"\' class=\'media-object\' style=\'width:60px\'>"+
            "</div>"+

            "<div class=\"media-body\">"+
                "<h4 class=\"media-heading\">"+uname+"<small id=\'timestamp\'> Posted on: "+pdate+"</small></h4>"+
                "<hr>"+
                "<p>"+ptext+"</p>"+
            "</div>"+
        "</div>"    
    );
}    

</script>